<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<link rel="icon" href="/img/icon.png" />
		<link rel="stylesheet" href="style.css" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>osu! Account Linker</title>
	</head>
	<body onload="getKey()">
		<div id="paste-box">
			<div id="title">Paste into discord to link:</div>
			<div id="key-container">
				<div id="key"></div>
				<button onclick="copy()" id="copy"></button>
			</div>
		</div>
	</body>
	<script>
		let queryString = window.location.search,
			urlParams = new URLSearchParams(queryString),
			keyBox = document.getElementById("key");
		function getKey() {
			keyBox.textContent = ".link " + urlParams.get("key");
			if (!urlParams.get("key")) {
				let title = document.getElementById("title");
				let key = document.getElementById("key-container");
				let box = document.getElementById("paste-box");
				let login = document.createElement("button");

				login.innerHTML = "Login with osu!";
				login.id = "login";
				login.onclick = () => {
					window.location.href =
						"https://osu.ppy.sh/oauth/authorize?client_id=13047&redirect_uri=https://clxxiii-discord-bot-osu-auth.herokuapp.com/&response_type=code&scope=identify";
				};

				title.innerHTML = "Connect your osu! account to discord!";
				key.outerHTML = "";
				box.appendChild(login);
			}
		}
		function copy() {
			let copyText = ".link " + urlParams.get("key");
			navigator.clipboard.writeText(copyText);
		}
	</script>
</html>
